"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.followOrganization = void 0;

var _models = require("../../../../../models");

var _keys = require("../../../../../models/keys");

const followOrganization = async (org_uuid, user) => {
  const organization = await _models.Organizations.findOne({
    where: {
      [_keys.OrganizationKeys.UUID]: org_uuid
    }
  });
  const contact = await _models.Contacts.findOne({
    where: {
      [_keys.ContactKeys.UUID]: user
    }
  });
  await organization.addFollowContact(contact);
  return organization;
};

exports.followOrganization = followOrganization;

const followOrganizationController = async (req, res, next) => {
  try {
    const organization = await followOrganization(req.body.org_uuid, req.user.uuid);
    res.json(organization);
  } catch (err) {
    next(err);
  }
};

var _default = followOrganizationController;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9yb3V0ZXMvdjEvb3JnYW5pemF0aW9uL2NvbnRyb2xsZXJzL2ZvbGxvd09yZ2FuaXphdGlvbi9pbmRleC50cyJdLCJuYW1lcyI6WyJmb2xsb3dPcmdhbml6YXRpb24iLCJvcmdfdXVpZCIsInVzZXIiLCJvcmdhbml6YXRpb24iLCJPcmdhbml6YXRpb25zIiwiZmluZE9uZSIsIndoZXJlIiwiT3JnYW5pemF0aW9uS2V5cyIsIlVVSUQiLCJjb250YWN0IiwiQ29udGFjdHMiLCJDb250YWN0S2V5cyIsImFkZEZvbGxvd0NvbnRhY3QiLCJmb2xsb3dPcmdhbml6YXRpb25Db250cm9sbGVyIiwicmVxIiwicmVzIiwibmV4dCIsImJvZHkiLCJ1dWlkIiwianNvbiIsImVyciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUNBOztBQUNBOztBQUVPLE1BQU1BLGtCQUFrQixHQUFHLE9BQU9DLFFBQVAsRUFBeUJDLElBQXpCLEtBQTBDO0FBQzFFLFFBQU1DLFlBQVksR0FBRyxNQUFNQyxzQkFBY0MsT0FBZCxDQUFzQjtBQUMvQ0MsSUFBQUEsS0FBSyxFQUFFO0FBQ0wsT0FBQ0MsdUJBQWlCQyxJQUFsQixHQUF5QlA7QUFEcEI7QUFEd0MsR0FBdEIsQ0FBM0I7QUFNQSxRQUFNUSxPQUFPLEdBQUcsTUFBTUMsaUJBQVNMLE9BQVQsQ0FBaUI7QUFDckNDLElBQUFBLEtBQUssRUFBRTtBQUNMLE9BQUNLLGtCQUFZSCxJQUFiLEdBQW9CTjtBQURmO0FBRDhCLEdBQWpCLENBQXRCO0FBTUEsUUFBTUMsWUFBWSxDQUFDUyxnQkFBYixDQUE4QkgsT0FBOUIsQ0FBTjtBQUVBLFNBQU9OLFlBQVA7QUFDRCxDQWhCTTs7OztBQWtCUCxNQUFNVSw0QkFBNEMsR0FBRyxPQUFPQyxHQUFQLEVBQVlDLEdBQVosRUFBaUJDLElBQWpCLEtBQTBCO0FBQzdFLE1BQUk7QUFDRixVQUFNYixZQUFZLEdBQUcsTUFBTUgsa0JBQWtCLENBQUNjLEdBQUcsQ0FBQ0csSUFBSixDQUFTaEIsUUFBVixFQUFvQmEsR0FBRyxDQUFDWixJQUFKLENBQVNnQixJQUE3QixDQUE3QztBQUVBSCxJQUFBQSxHQUFHLENBQUNJLElBQUosQ0FBU2hCLFlBQVQ7QUFDRCxHQUpELENBSUUsT0FBT2lCLEdBQVAsRUFBWTtBQUNaSixJQUFBQSxJQUFJLENBQUNJLEdBQUQsQ0FBSjtBQUNEO0FBQ0YsQ0FSRDs7ZUFVZVAsNEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXF1ZXN0SGFuZGxlciB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgT3JnYW5pemF0aW9ucywgQ29udGFjdHMgfSBmcm9tICdtb2RlbHMnO1xuaW1wb3J0IHsgT3JnYW5pemF0aW9uS2V5cywgQ29udGFjdEtleXMgfSBmcm9tICdtb2RlbHMva2V5cyc7XG5cbmV4cG9ydCBjb25zdCBmb2xsb3dPcmdhbml6YXRpb24gPSBhc3luYyAob3JnX3V1aWQ6IHN0cmluZywgdXNlcjogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IG9yZ2FuaXphdGlvbiA9IGF3YWl0IE9yZ2FuaXphdGlvbnMuZmluZE9uZSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIFtPcmdhbml6YXRpb25LZXlzLlVVSURdOiBvcmdfdXVpZCxcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IGNvbnRhY3QgPSBhd2FpdCBDb250YWN0cy5maW5kT25lKHtcbiAgICB3aGVyZToge1xuICAgICAgW0NvbnRhY3RLZXlzLlVVSURdOiB1c2VyLFxuICAgIH0sXG4gIH0pO1xuXG4gIGF3YWl0IG9yZ2FuaXphdGlvbi5hZGRGb2xsb3dDb250YWN0KGNvbnRhY3QpO1xuXG4gIHJldHVybiBvcmdhbml6YXRpb247XG59O1xuXG5jb25zdCBmb2xsb3dPcmdhbml6YXRpb25Db250cm9sbGVyOiBSZXF1ZXN0SGFuZGxlciA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IG9yZ2FuaXphdGlvbiA9IGF3YWl0IGZvbGxvd09yZ2FuaXphdGlvbihyZXEuYm9keS5vcmdfdXVpZCwgcmVxLnVzZXIudXVpZCk7XG5cbiAgICByZXMuanNvbihvcmdhbml6YXRpb24pO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBuZXh0KGVycik7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGZvbGxvd09yZ2FuaXphdGlvbkNvbnRyb2xsZXI7XG4iXX0=